<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
  xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.9.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

  <changeSet id="001_create_payments_collection" author="NAKozlovskaya">
    <ext:createCollection collectionName="payments">
      <ext:validator>
        {
        "$jsonSchema": {
        "bsonType": "object",
        "required": ["order_id", "user_id", "status", "timestamp", "payment_amount"],
        "properties": {
        "order_id": {
        "bsonType": "string",
        "description": "Must be a string and is required"
        },
        "user_id": {
        "bsonType": "string",
        "description": "Must be a string and is required"
        },
        "status": {
        "bsonType": "string",
        "description": "Must be a string and is required",
        "enum": ["pending", "completed", "failed", "refunded"]
        },
        "timestamp": {
        "bsonType": "date",
        "description": "Must be a date and is required"
        },
        "payment_amount": {
        "bsonType": "decimal",
        "description": "Must be a decimal and is required"
        }
        }
        }
        }
      </ext:validator>
      <ext:validationLevel>strict</ext:validationLevel>
      <ext:validationAction>error</ext:validationAction>
    </ext:createCollection>
  </changeSet>

</databaseChangeLog>